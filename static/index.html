<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <meta name="theme-color" content="#0a0e1a">
    <meta name="description" content="PotatoBugCrypto - Track crypto prices with psychedelic visualizations">
    <meta name="apple-mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-status-bar-style" content="black-translucent">
    <meta name="apple-mobile-web-app-title" content="PotatoBug">

    <title>PotatoBugCrypto v12</title>
    <link rel="stylesheet" href="/static/style.css">
    <link rel="manifest" href="/static/manifest.json">

    <!-- PWA Icons -->
    <link rel="apple-touch-icon" sizes="180x180" href="/static/icon-180.png">
    <link rel="icon" type="image/png" sizes="32x32" href="/static/icon-32.png">
</head>
<body>
    <!-- Room Code Modal (shows first) -->
    <div id="roomModal" class="modal">
        <canvas id="arcRaidersCanvas" style="position: absolute; top: 0; left: 0; width: 100%; height: 100%; pointer-events: none; z-index: 1;"></canvas>
        <div class="modal-content" style="position: relative; z-index: 2;">
            <h2>ü•î PotatoBugCrypto</h2>
            <p class="modal-subtitle">Enter a room to chat with a bug and track crypto</p>

            <div class="room-options">
                <div class="username-section">
                    <input type="text" id="usernameInput" placeholder="Your username" maxlength="20">
                </div>

                <input type="text" id="customRoomInput" placeholder="Room name" maxlength="20" value="goop">
                <button id="enterBtn" class="primary-btn">ENTER POTATO BUG CRYPTO</button>
            </div>
        </div>
    </div>

    <!-- Main App Container -->
    <div id="appContainer" style="display: none;">
        <!-- Header -->
        <header>
            <div class="header-left">
                <h1>ü•î PotatoBug</h1>
                <span class="room-code-display" id="roomCodeDisplay"></span>
            </div>
            <div class="header-right">
                <button id="themeToggle" class="icon-btn" title="Toggle theme">‚òÄÔ∏è</button>
                <button id="settingsBtn" class="icon-btn" title="Settings">‚öôÔ∏è</button>
            </div>
        </header>

        <!-- Coins Section -->
        <section class="coins-section">
            <div class="coins-header">
                <h2>Coins</h2>
                <button id="addCoinBtn" class="icon-btn">+ Add Coin</button>
            </div>
            <div id="selectedCoinsDisplay" class="selected-coins"></div>
            <div id="coinPrices" class="coin-prices"></div>
        </section>

        <!-- Add Coin Modal -->
        <div id="addCoinModal" class="modal" style="display: none;">
            <div class="modal-content">
                <div class="modal-header">
                    <h2>Add Coin</h2>
                    <button class="close-btn" id="closeAddCoin">√ó</button>
                </div>
                <input type="text" id="coinSearchInput" placeholder="Search coins..." autocomplete="off">
                <div id="coinSearchResults" class="coin-search-results"></div>
            </div>
        </div>

        <!-- Chat Section (moved up for mobile priority) -->
        <section class="chat-section">
            <div class="chat-header">
                <h2>Chat</h2>
                <span class="user-count" id="userCount">0 online</span>
            </div>
            <div id="chatMessages" class="chat-messages"></div>
            <div class="chat-interaction-btns">
                <button id="randomQuoteBtn" class="chat-btn" title="Send random quote">RANDOM</button>
                <button id="sadEmojiBtn" class="chat-btn emoji-btn" title="Send sad face">üò¢</button>
                <button id="rocketEmojiBtn" class="chat-btn emoji-btn" title="Send rocket">üöÄ</button>
                <button id="fireworksBtn" class="chat-btn fireworks-btn" title="Trigger fireworks for everyone!">üéÜ FIREWORKS</button>
                <button id="musicBtn" class="chat-btn music-btn" title="Toggle cyberpunk music">üéµ MUSIC</button>
            </div>
            <div class="chat-input-container">
                <input type="text" id="chatInput" placeholder="Type a message..." maxlength="200">
                <button id="sendBtn">Send</button>
            </div>
        </section>

        <!-- Cassette Tape Music Player -->
        <div id="cassettePlayer" class="cassette-player" style="display: none;">
            <div class="cassette-header">
                <span class="cassette-title" id="cassetteTrackName">CYBERPUNK MIX</span>
                <button class="cassette-close" id="closeCassette">√ó</button>
            </div>

            <div class="cassette-body">
                <!-- Tape Reels -->
                <div class="tape-reels">
                    <div class="reel left-reel" id="leftReel">
                        <div class="reel-center"></div>
                        <div class="reel-spoke"></div>
                        <div class="reel-spoke"></div>
                        <div class="reel-spoke"></div>
                        <div class="reel-spoke"></div>
                    </div>
                    <div class="reel right-reel" id="rightReel">
                        <div class="reel-center"></div>
                        <div class="reel-spoke"></div>
                        <div class="reel-spoke"></div>
                        <div class="reel-spoke"></div>
                        <div class="reel-spoke"></div>
                    </div>
                </div>

                <!-- Track Info -->
                <div class="track-info">
                    <div class="track-counter">
                        <span id="currentTrackNum">1</span> / <span id="totalTracks">8</span>
                    </div>
                </div>

                <!-- Controls -->
                <div class="cassette-controls">
                    <button class="control-btn" id="prevTrack" title="Previous">‚óÑ</button>
                    <button class="control-btn play-btn" id="playBtn" title="Play">‚ñ∫</button>
                    <button class="control-btn" id="pauseBtn" title="Pause" style="display: none;">‚ùö‚ùö</button>
                    <button class="control-btn" id="nextTrack" title="Next">‚ñ∫</button>
                </div>
            </div>
        </div>

        <!-- Hidden audio element -->
        <audio id="synthMusic" preload="metadata" crossorigin="anonymous"></audio>

        <!-- Financial Indicators -->
        <section class="financial-indicators-section">
            <h2>Markets</h2>
            <div id="financialIndicators" class="financial-grid">
                <div class="indicator-card">
                    <div class="indicator-label">10Y Treasury</div>
                    <div class="indicator-value" id="treasury10y">--</div>
                </div>
                <div class="indicator-card">
                    <div class="indicator-label">Gold (oz)</div>
                    <div class="indicator-value" id="goldPrice">--</div>
                </div>
                <div class="indicator-card">
                    <div class="indicator-label">Silver (oz)</div>
                    <div class="indicator-value" id="silverPrice">--</div>
                </div>
                <div class="indicator-card">
                    <div class="indicator-label">Oil (bbl)</div>
                    <div class="indicator-value" id="oilPrice">--</div>
                </div>
            </div>
        </section>

        <!-- Weather Section -->
        <section class="weather-section">
            <div class="weather-header">
                <h2>Weather</h2>
                <button id="editWeatherBtn" class="icon-btn" title="Set zip code">üìç</button>
            </div>
            <div id="weatherDisplay" class="weather-display">
                <p class="weather-prompt">Enter zip code on red pin for local weather</p>
            </div>
        </section>

        <!-- Weather Zip Code Modal -->
        <div id="weatherModal" class="modal" style="display: none;">
            <div class="modal-content">
                <div class="modal-header">
                    <h2>üìç Set Your Location</h2>
                    <button class="close-btn" id="closeWeather">√ó</button>
                </div>
                <p class="modal-description">Enter your 5-digit zip code to see local weather</p>
                <input type="text" id="zipCodeInput" placeholder="Enter 5-digit zip code (e.g., 10001)" maxlength="5" pattern="\d{5}">
                <button id="saveZipBtn" class="primary-btn">Save Weather Location</button>
            </div>
        </div>

        <!-- News Headlines Section -->
        <section class="news-headlines-section">
            <h2>Top Crypto & Finance News</h2>
            <div id="newsHeadlinesList" class="news-headlines-list">
                <p class="loading">Loading headlines...</p>
            </div>
        </section>

        <!-- Psychedelic Visualization Section -->
        <section class="viz-section">
            <div class="viz-header">
                <h2>Market Vibes</h2>
                <button id="fullscreenVizBtn" class="icon-btn">‚õ∂</button>
            </div>
            <canvas id="psychedelicCanvas"></canvas>
            <div class="viz-overlay" id="vizOverlay"></div>
        </section>

        <!-- Quote Display -->
        <div class="quote-display" id="quoteDisplay"></div>

        <!-- Settings Modal -->
        <div id="settingsModal" class="modal" style="display: none;">
            <div class="modal-content">
                <div class="modal-header">
                    <h2>Settings</h2>
                    <button class="close-btn" id="closeSettings">√ó</button>
                </div>

                <div class="settings-section">
                    <h3>Quote Settings</h3>
                    <label>
                        <input type="checkbox" id="quotesEnabled" checked>
                        Show rotating quotes
                    </label>
                    <label>
                        Quote interval: <span id="quoteIntervalValue">2</span> minutes
                        <input type="range" id="quoteInterval" min="2" max="10" value="2">
                    </label>
                </div>

                <div class="settings-section">
                    <h3>Visualization Quality</h3>
                    <select id="vizQuality">
                        <option value="auto">Auto (detect device)</option>
                        <option value="low">Low (better performance)</option>
                        <option value="medium">Medium</option>
                        <option value="high">High (better visuals)</option>
                    </select>
                </div>

                <div class="settings-section">
                    <h3>News Headlines</h3>
                    <label>
                        <input type="checkbox" id="newsEnabled" checked>
                        Show crypto news
                    </label>
                </div>

                <div class="settings-section">
                    <h3>Room Info</h3>
                    <p>Room Code: <strong id="settingsRoomCode"></strong></p>
                    <button id="copyRoomCode" class="secondary-btn">Copy Room Code</button>
                    <button id="leaveRoom" class="danger-btn">Leave Room</button>
                </div>
            </div>
        </div>

        <!-- News Headlines (bottom ticker) -->
        <div class="news-ticker" id="newsTicker"></div>

        <!-- Fireworks Canvas Overlay -->
        <canvas id="fireworksCanvas" style="display: none;"></canvas>
    </div>

    <script src="/static/script.js"></script>
</body>
</html>
